<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Event Management System</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        h1 {
            color: #333;
        }
        form, .operation {
            border: 1px solid #ddd;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 5px;
            background: #f9f9f9;
        }
        input, button, select {
            margin: 5px 0;
            padding: 10px;
            width: 100%;
        }
        button {
            background-color: #007BFF;
            color: white;
            border: none;
            cursor: pointer;
        }
        button:hover {
            background-color: #0056b3;
        }
        pre {
            background: #f4f4f4;
            padding: 15px;
            border-radius: 5px;
            overflow: auto;
        }
    </style>
</head>
<body>
    <h1>Event Management System</h1>

    <!-- Add Customer -->
    <form id="addCustomerForm">
        <h2>Add Customer</h2>
        <input type="text" id="customerMail" placeholder="Email" required>
        <input type="text" id="customerCreditInfo" placeholder="Credit Info">
        <input type="text" id="customerFName" placeholder="First Name" required>
        <input type="text" id="customerLName" placeholder="Last Name" required>
        <button type="submit">Add Customer</button>
    </form>

    <!-- Add Event -->
    <form id="addEventForm">
        <h2>Add Event</h2>
        <input type="text" id="eventName" placeholder="Event Name" required>
        <input type="text" id="eventType" placeholder="Event Type">
        <input type="time" id="eventTime" placeholder="Time">
        <input type="date" id="eventDate" placeholder="Date">
        <input type="number" id="eventCapacity" placeholder="Capacity" required>
        <button type="submit">Add Event</button>
    </form>

    <!-- Show Data -->
    <div class="operation">
        <h2>Show Data</h2>
        <select id="showDataType">
            <option value="customers">Customers</option>
            <option value="events">Events</option>
            <option value="tickets">Tickets</option>
            <option value="reservations">Reservations</option>
        </select>
        <button onclick="showData()">Show Data</button>
        <pre id="dataDisplay">Click 'Show Data' to display information here...</pre>
    </div>

    <!-- Query Available Tickets -->
    <form id="queryTicketsForm">
        <h2>Query Available Tickets</h2>
        <input type="number" id="eventIDTickets" placeholder="Event ID" required>
        <button type="submit">Get Available Tickets</button>
        <pre id="ticketsDisplay">Available tickets will be displayed here...</pre>
    </form>

    <!-- Query Customer Reservations -->
    <form id="queryReservationsForm">
        <h2>Query Customer Reservations</h2>
        <input type="number" id="customerIDReservations" placeholder="Customer ID" required>
        <button type="submit">Get Reservations</button>
        <pre id="reservationsDisplay">Reservations will be displayed here...</pre>
    </form>

    <!-- Query Reservation Cost -->
    <form id="queryCostForm">
        <h2>Query Reservation Cost</h2>
        <input type="number" id="reservationIDCost" placeholder="Reservation ID" required>
        <button type="submit">Get Reservation Cost</button>
        <pre id="costDisplay">Reservation cost will be displayed here...</pre>
    </form>

    <script>
        // Function to handle form submissions and display results
        async function postData(url, data) {
            const res = await fetch(url, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });
            return res.json();
        }

        document.getElementById('addCustomerForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const data = {
                mail: document.getElementById('customerMail').value,
                credit_info: document.getElementById('customerCreditInfo').value,
                f_name: document.getElementById('customerFName').value,
                l_name: document.getElementById('customerLName').value
            };
            const response = await postData('/customers', data);
            alert(response.message || 'Customer added successfully!');
        });

        document.getElementById('addEventForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const data = {
                name: document.getElementById('eventName').value,
                type: document.getElementById('eventType').value,
                time: document.getElementById('eventTime').value,
                date: document.getElementById('eventDate').value,
                capacity: parseInt(document.getElementById('eventCapacity').value)
            };
            const response = await postData('/events', data);
            alert(response.message || 'Event added successfully!');
        });

        async function showData() {
            const dataType = document.getElementById('showDataType').value;
            const res = await fetch(`/${dataType}`);
            const data = await res.json();
            document.getElementById('dataDisplay').innerText = JSON.stringify(data, null, 2);
        }

        document.getElementById('queryTicketsForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const eventId = document.getElementById('eventIDTickets').value;
            const res = await fetch(`/available_tickets/${eventId}`);
            const tickets = await res.json();
            document.getElementById('ticketsDisplay').innerText = JSON.stringify(tickets, null, 2);
        });

        document.getElementById('queryReservationsForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const customerId = document.getElementById('customerIDReservations').value;
            const res = await fetch(`/customer_reservations/${customerId}`);
            const reservations = await res.json();
            document.getElementById('reservationsDisplay').innerText = JSON.stringify(reservations, null, 2);
        });

        document.getElementById('queryCostForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const reservationId = document.getElementById('reservationIDCost').value;
            const res = await fetch(`/reservation_cost/${reservationId}`);
            const cost = await res.json();
            document.getElementById('costDisplay').innerText = JSON.stringify(cost, null, 2);
        });
    </script>

<div class="operation">
    <h2>Delete Resource</h2>
    <select id="deleteResourceType">
        <option value="customers">Customer</option>
        <option value="events">Event</option>
        <option value="tickets">Ticket</option>
        <option value="reservations">Reservation</option>
    </select>
    <input type="number" id="deleteResourceID" placeholder="Resource ID" required>
    <button onclick="deleteResource()">Delete Resource</button>
    <pre id="deleteResponse">Delete response will be displayed here...</pre>
</div>

<script>
    async function deleteResource() {
        const resourceType = document.getElementById('deleteResourceType').value;
        const resourceId = document.getElementById('deleteResourceID').value;

        if (!resourceId) {
            alert('Please enter a valid resource ID.');
            return;
        }

        const response = await fetch(`/${resourceType}/${resourceId}`, {
            method: 'DELETE',
        });

        const result = await response.json();
        document.getElementById('deleteResponse').innerText = JSON.stringify(result, null, 2);

        if (response.ok) {
            alert(`${resourceType.slice(0, -1)} with ID ${resourceId} deleted successfully!`);
        } else {
            alert(`Failed to delete ${resourceType.slice(0, -1)}. Check console for details.`);
            console.error(result);
        }
    }
</script>

</body>
</html>

